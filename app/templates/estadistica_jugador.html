<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{ estadistica }} - {{ jugador.nombre }}</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'myapp/css/estadistica_jugador.css' %}" />
    <link rel="stylesheet" href="{% static 'myapp/css/menu.css' %}" />
    <link rel="stylesheet" href="{% static 'myapp/css/topnav.css' %}" />
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Rajdhani:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
  </head>
  <body>
    {% include 'partials/header.html' %}
    {% include 'partials/topnav.html' %}
    
    <div class="main-container">
      <!-- HEADER HERO -->
      <div class="hero-section">
        <div class="hero-background"></div>
        <div class="hero-content">
          <a href="{% url 'jugador_detalle' jugador.id %}" class="btn-back">
            <i class="bx bx-arrow-back"></i>
            <span>Volver</span>
          </a>
          <div class="hero-info">
            <div class="player-avatar">
              {% if jugador.foto %}
                <img src="{{ jugador.foto.url }}" alt="{{ jugador.nombre }}" />
              {% else %}
                <div class="avatar-placeholder">
                  {% if jugador.equipo.logo %}
                    <img src="{{ jugador.equipo.logo }}" alt="{{ jugador.equipo.nombre }}" class="team-logo-avatar" />
                  {% else %}
                    <div class="team-initial">{{ jugador.equipo.nombre|first }}</div>
                  {% endif %}
                </div>
              {% endif %}
            </div>
            <div class="hero-text">
              <div class="name-dorsal-container">
                <h1 class="dorsal-colo">{{ jugador.nombre }}</h1>
                {% if jugador.dorsal %}
                  <span class="player-dorsal">{{ jugador.dorsal }}</span>
                {% endif %}
              </div>
              <p class="stat-name">{{ estadistica }}</p>
              <div class="team-info">
                
                <div class="team-details">
                  <div class="position-info">
                    {% if jugador.posicion %}
                      <span class="position-tag">{{ jugador.posicion }}</span>
                    {% endif %}
                    {% if jugador.posicion_secundaria %}
                      <span class="position-tag secondary">{{ jugador.posicion_secundaria }}</span>
                    {% endif %}
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="stats-hero">
            <div class="stat-hero-card">
              <div class="stat-value">{{ stat_value|default:"N/A" }}</div>
              <div class="stat-label">Actual</div>
            </div>
            <div class="stat-hero-card">
              <div class="stat-value">{{ promedio|default:"N/A" }}</div>
              <div class="stat-label">Promedio Liga</div>
            </div>
            <div class="stat-hero-card">
              <div class="stat-value">{{ percentil|default:"N/A" }}%</div>
              <div class="stat-label">Percentil</div>
            </div>
          </div>
        </div>
      </div>

      <!-- GR√ÅFICOS GRID -->
      <div class="charts-grid">
        <!-- RADAR CHART -->
        <div class="chart-card radar-card">
          <div class="chart-header">
            <h3><i class="bx bx-radar"></i> An√°lisis de Rendimiento</h3>
            <div class="chart-controls">
              <select id="radar-jugador-group-selector" class="control-select">
                <option value="ofensivos">üî¥ Ofensivos</option>
                <option value="defensivos">üõ°Ô∏è Defensivos</option>
                <option value="creacion">‚ö° Creaci√≥n</option>
                <option value="arquero">ü•Ö Arquero</option>
              </select>
              <select id="posicion-jugador-selector" class="control-select" style="display: none"></select>
            </div>
          </div>
          <div class="chart-content">
            <div id="radar-jugador-chart-container"></div>
          </div>
        </div>

        <!-- BOXPLOT CHART -->
        <div class="chart-card boxplot-card">
          <div class="chart-header">
            <h3><i class="bx bx-bar-chart-square"></i> Distribuci√≥n</h3>
            <div class="chart-controls">
              <label for="posicion-boxplot-selector">Posici√≥n:</label>
              <select id="posicion-boxplot-selector" class="control-select"></select>
            </div>
          </div>
          <div class="chart-content">
            <div id="boxplot-jugador-chart-container"></div>
          </div>
        </div>
      </div>

      <!-- GR√ÅFICO DE DISPERSI√ìN -->
      <div class="chart-card scatter-card">
        <div class="chart-header">
          <h3><i class="bx bx-scatter-chart"></i> An√°lisis de Dispersi√≥n</h3>
          <div class="chart-controls">
            <label for="posicion-dispersion-selector">Posici√≥n:</label>
            <select id="posicion-dispersion-selector" class="control-select"></select>
            <label for="stat-y-selector">Eje Y:</label>
            <select id="stat-y-selector" class="control-select"></select>
          </div>
        </div>
        <div class="chart-content scatter-content">
          <div id="chart-dispersion-jugador"></div>
        </div>
      </div>
    </div>

    <script>
      window.jugadorData = {
          jugadorId: {{ jugador.id }},
          jugadorNombre: "{{ jugador.nombre }}",
          estadistica: "{{ estadistica }}",
          datosGrafico: {{ datos_json|safe }}
      };
    </script>
    <script src="{% static 'myapp/js/estadistica_jugador.js' %}"></script>
    <script src="{% static 'myapp/js/topnav.js' %}"></script>
  </body>
</html>

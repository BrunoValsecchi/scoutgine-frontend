{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ScoutGine | Estadísticas de Jugadores</title>
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ag-grid-community@29.0.0/styles/ag-grid.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ag-grid-community@29.0.0/styles/ag-theme-alpine.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700&family=Rajdhani:wght@300;400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{% static 'myapp/css/style.css' %}" />

  <script src="https://cdn.jsdelivr.net/npm/ag-grid-community@29.0.0/dist/ag-grid-community.min.noStyle.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
  <script src="https://unpkg.com/boxicons@2.1.4/dist/boxicons.js"></script>
  <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>


  <script src="{% static 'myapp/js/grafico.js' %}"></script>
  <script src="{% static 'myapp/js/headerlan.js' %}"></script>
  <script src="{% static 'myapp/js/presentacion.js' %}"></script>


</head>
<body>
  {% include 'partials/headerlan.html' %}
  {% include 'partials/presentacion.html' %}
  {% include 'partials/footerlan.html' %}

 
</body>
</html>


<!-- 
{% load static %}
<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ag-grid-community@29.0.0/styles/ag-grid.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ag-grid-community@29.0.0/styles/ag-theme-alpine.min.css">
    <title>Estadisticas de Jugadores</title>
    <script src="https://cdn.jsdelivr.net/npm/ag-grid-community@29.0.0/dist/ag-grid-community.min.noStyle.js"></>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
    <link rel="stylesheet" href="{% static 'myapp/style.css' %}" />
  </head>
  <body>
    <div class="container">
      <div>
        <h2>Gráfico de estadísticas seleccionadas</h2>
        {{ grafico|safe }}
      </div>

      <div class="seccion extra">
        <h2>Datos generales del partido</h2>
        <div class="card">
          <h2>{{ info.torneo }}</h2>
          <p class="info"><strong>Ronda:</strong> {{ info.ronda }}</p>
          <p class="info"><strong>Fecha:</strong> {{ info.fecha }}</p>
          <p class="info"><strong>Partido:</strong> {{ info.equipo_local }} vs {{ info.equipo_visitante }}</p>
          <p class="info"><strong>Marcador:</strong> {{ info.marcador }}</p>
          <p class="info"><strong>Estadio:</strong> {{ info.estadio }} ({{ info.ciudad }})</p>
          <p class="info"><strong>Árbitro:</strong> {{ info.arbitro }}</p>
        </div>
      </div>

      <div>
        <h2>Estadísticas detalladas</h2>
        {{ tabla|safe }}
      </div>
    </div>  

    <h2>Tabla Interactiva con AG Grid</h2>
    
    <!-- Este div debe estar visible para que AG Grid funcione -->
    <!-- <div id="myGrid" class="ag-theme-alpine" style="height: 500px; width: 100%; display: block;"></div>
    <div>
      <h2>Percentiles de Defensores</h2>
      {{ grafico_percentiles|safe }}
  </div>


<div>
  <h2>Comparar Jugadores</h2>
  <form method="get">
      <div style="margin-bottom: 20px;">
          <select name="jugador1" style="margin-right: 10px;">
              <option value="">Selecciona primer jugador</option>
              {% for jugador in jugadores_disponibles %}
                  <option value="{{ jugador }}" {% if jugador == jugador1_seleccionado %}selected{% endif %}>
                      {{ jugador }}
                  </option>
              {% endfor %}
          </select>
          <select name="jugador2" style="margin-right: 10px;">
              <option value="">Selecciona segundo jugador</option>
              {% for jugador in jugadores_disponibles %}
                  <option value="{{ jugador }}" {% if jugador == jugador2_seleccionado %}selected{% endif %}>
                      {{ jugador }}
                  </option>
              {% endfor %}
          </select>
          <button type="submit">Comparar</button>
      </div>
  </form>
</div> -->

<!-- <script>
  document.addEventListener('DOMContentLoaded', function() {
    console.log("DOM completamente cargado");

    try {
      let rowData;
      let columnDefs;

      try {
        rowData = JSON.parse('{{ tabla_data|escapejs }}');
        const allColumnDefs = JSON.parse('{{ column_defs|escapejs }}');

        rowData = rowData
          .filter(player => player.minutesPlayed > 200)
          .sort((a, b) => (b.goals || 0) - (a.goals || 0))
          .slice(0, 10);


        const playerIndex = allColumnDefs.findIndex(col => col.field === 'player');
        if (playerIndex !== -1) {
          const playerColDef = allColumnDefs[playerIndex];
          columnDefs = [playerColDef];
          allColumnDefs.forEach((colDef, index) => {
            if (index !== playerIndex && columnDefs.length < 8) {
              columnDefs.push(colDef);
            }
          });
        } else {
          columnDefs = allColumnDefs.slice(0, 8);
        }

        console.log("Columnas procesadas:", columnDefs);
      } catch (parseError) {
        console.error("Error al parsear datos de Django:", parseError);
      }

      const gridOptions = {
        columnDefs: columnDefs,
        rowData: rowData,
        defaultColDef: {
          sortable: true,
          filter: true,
          resizable: true,
          flex: 1
        },
        pagination: true,
        paginationPageSize: 10
      };

      const gridDiv = document.querySelector('#myGrid');
      if (gridDiv) {
        console.log("Elemento grid encontrado, inicializando AG Grid");
        new agGrid.Grid(gridDiv, gridOptions);
      } else {
        console.error("Elemento #myGrid no encontrado en el DOM");
      }
    } catch (error) {
      console.error("Error general al inicializar AG Grid:", error);
    }
  });
</script>
    
    
  </body>
</html> --> 